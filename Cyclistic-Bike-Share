--CREATE TABLE 
CREATE TABLE tripdata_all (
	ride_id	varchar(50),
	rideable_type varchar(20),
	started_at timestamp,
	ended_at timestamp,
	start_station_name varchar(100),
	start_station_id varchar(50),
	end_station_name varchar(100),
	end_station_id	varchar(50),
	start_lat numeric,	
	start_lng numeric,
	end_lat	numeric,
	end_lng numeric,	
	member_casual varchar(50)
)

--INSERTING ALL datasets

-- CLEANING DATA
--Removing column 
ALTER TABLE public.tripdata_all
DROP COLUMN start_station_id;

ALTER TABLE public.tripdata_all
DROP COLUMN end_station_id;

ALTER TABLE public.tripdata_all
DROP COLUMN start_lat;

ALTER TABLE public.tripdata_all
DROP COLUMN start_lng;

ALTER TABLE public.tripdata_all
DROP COLUMN end_lat;

ALTER TABLE public.tripdata_all
DROP COLUMN end_lng;

--RESULTS -> COLUMN DECREASES INTO 7 COLUMN

-- CHECKING FOR ERRORS IN USER AND BIKE TYPES

SELECT DISTINCT(rideable_type)
FROM public.tripdata_all;

SELECT DISTINCT(member_casual)
FROM public.tripdata_all;

-- CHECKING FOR DUPLICATES
SELECT COUNT(DISTINCT(start_station_name)), COUNT(DISTINCT(end_station_name))
FROM public.tripdata_all

SELECT DISTINCT(start_station_name)
FROM public.tripdata_all;

SELECT DISTINCT(end_station_name)
FROM public.tripdata_all;

SELECT ride_id, count(*)
FROM public.tripdata_all
GROUP BY ride_id
HAVING count(*) > 1;

-- CHECK MISSING DATA
SELECT * 
FROM tripdata_all
WHERE start_station_name IS NULL;

SELECT * 
FROM tripdata_all
WHERE end_station_name IS NULL;

SELECT * 
FROM tripdata_all
WHERE started_at IS NULL;

SELECT * 
FROM tripdata_all
WHERE ended_at IS NULL; 

--DELETE rows for blank values in start_station_name and end_station_name column 
DELETE FROM public.tripdata_all
WHERE start_station_name IS NULL;
--TOTAL 875716 rows deleted

DELETE FROM public.tripdata_all
WHERE end_station_name IS NULL;
--TOTAL 512092 rows deleted
--there is 4332069 rows remaining  

--MANIPULATING DATA
--CREATE ride_duration COLUMN
ALTER TABLE public.tripdata_all
ADD ride_duration interval;

UPDATE public.tripdata_all
SET 

-- ANALYZING DATA
